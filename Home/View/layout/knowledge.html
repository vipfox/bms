<link rel="stylesheet" href="{$Think.config.PUBLIC_URL}/Js/treeview/jquery.treeview.css" />
<link rel="stylesheet" href="{$Think.config.PUBLIC_URL}/Js/treeview/demo/screen.css" />

<div id="sidebar">
    <div id="mail_inside" class="box">
        <div class="title"><span class="left"></span>知识统计</div>
        <div class="content">
            <ul id="my_report" class="list_ul">
                <li>总数：<span id="all_count"></span>条</li>
                <li>昨日：<span id="prev_count"></span>条</li>
                <li>今日：<span id="now_count"></span>条</li>
            </ul>
        </div>
    </div>
    <div id="report" class="box">
        <div class="title"><span class="left"></span>知识分类</div>
        <div class="content">
            <ul id="red" class="treeview-red">
                
            </ul>
        </div>
    </div>
    <div id="calendar_sidbar" class="box">
        <div class="title"><span class="left2"></span>日历</div>
        <div class="content">
            <div id="mod_calendar">    
                <div class="calendar_year">       
                    <a title="上一年" id="prev_year" href="javascript:;" class="c_tx mod_arr arr_back"><img align="absmiddle" style="width:16px;height:12px;" src="{$Think.config.PUBLIC_URL}/images/ico/prev.gif"></a> 
                    <strong  class="year" title="2013"></strong>
                    <a title="下一年" id="next_year" href="javascript:;" class="c_tx mod_arr arr_pre"><img align="absmiddle" style="width:16px;height:12px;" src="{$Think.config.PUBLIC_URL}/images/ico/next.gif"></a>     
                </div>
                <ul class="calendar_month">     
                    
                </ul>
            </div>
        </div>
    </div>
    <div id="zimushuzi" class="box">
        <div class="title"><span class="left2"></span>按字母或数字顺序浏览</div>
        <div class="content">
            <div id="zimu">
                <ul class="col-ul">
                    <li><a href="?m=knowledge&a=index&pinyin=A">A</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=B">B</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=C">C</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=D">D</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=E">E</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=F">F</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=G">G</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=H">H</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=I">I</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=J">J</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=K">K</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=L">L</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=M">M</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=N">N</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=O">O</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=P">P</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=Q">Q</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=R">R</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=S">S</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=T">T</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=U">U</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=V">V</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=W">W</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=X">X</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=Y">Y</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=Z">Z</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=0">0</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=1">1</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=2">2</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=3">3</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=4">4</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=5">5</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=6">6</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=7">7</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=8">8</a></li>
                    <li><a href="?m=knowledge&a=index&pinyin=9">9</a></li>
                </ul>
            </div>
        </div>
    </div>
</div>
<style>
    #mod_calendar .calendar_year {
        padding: 5px 0;
        text-align: center;
        width:183px;
        margin: auto;
        background-color:#BBCFE5;
        border: 1px solid blue;
    }
    #mod_calendar .calendar_year .mod_arr {
        border-bottom-color: transparent;
        border-top-color: transparent;
        overflow: hidden;
        vertical-align: middle;
    }
    #mod_calendar .calendar_year .arr_back {
        border-left-color: transparent;
        border-right-style: solid;
    }
    #mod_calendar .calendar_year .arr_pre {
        border-left-style: solid;
        border-right-color: transparent;
    }

    #mod_calendar .calendar_month {
        background-color:#BBCFE5;
        width:184px;
        margin:auto;
        text-align: center;
        border-left:1px solid blue;
    }
    #mod_calendar .calendar_month:after {
        clear: both;
        content: "";
        display: block;
        height: 0;
    }
    #mod_calendar .calendar_month li {
        border: 1px solid blue;
        border-width: 0 1px 1px 0;
        float: left;
        height: 25px;
        line-height: 25px;
        text-align: center;
        width: 45px;
    }
    #mod_calendar .calendar_month li a {
        cursor: pointer;
        display: block;
        height: 40px;
    }
    #mod_calendar .calendar_month li span {
        display: block;
    }
    #mod_calendar .calendar_month .bg6 a {
        font-weight: 700;
    }
    #mod_calendar .calendar_year .year {
        margin: 0 20px;
    }
    #mod_calendar .calendar_year a:hover {
        cursor: pointer;
    }
    #zimu .col-ul{
        text-align: center;
        margin:auto;
    }
    #zimu li{
        float: left;
        width:31px;
        line-height:20px;
        text-align: center;
    }
    #zimu .col-ul:after {
        clear: both;
        content: "";
        display: block;
        height: 0;
    }
    #calendar_sidbar .left2{
        background: url(public/images/ico/due_date.png) no-repeat;
        width:16px;
        height: 16px;
        padding-left: 8px;
        padding-right: 10px;
    }
    #zimushuzi #zimu{
        *margin-bottom:15px; /* 对ie7有效 */
    }
    #zimushuzi .left2{
        background: url(public/images/ico/search.png) no-repeat;
        width:16px;
        padding-left: 8px;
        padding-right: 10px;
    }

    #tag_menu .tag_ul li{
        float: left;
        padding: 5px;
        line-height:20px;
        text-align: center;
    }
    #tag_menu .tag_ul:after{
        clear: both;
        content: '';
        display: block;
        height: 0;
    }
</style>
<script>
    $(document).ready(function(){
        load_calendar();
        get_category();
        get_article_count();
    });
     
    function get_category(){
        $.ajax({
            type: "POST",
            url: "?m=category&a=get_category_tree",
            cache:false,
            dataType: 'html',
            success: function(msg){
                //console.log(msg);
                var branches=$("#red").html(msg);
                $("#red").treeview({ 
                    add: branches,
                    animated: "fast",
                    collapsed: true,
                    persist: "location"
                });    
            }
        });
    };
    
    $('#prev_year').live('click',function(){
        var year=$('.year').attr('title');
        var prev_year= parseInt(year)-1;
        $('.year').attr('title',prev_year);
        $('.year').html(""+prev_year+"年");
        var html=load_calendar_month(prev_year);
        $('.calendar_month').html(html);
    });
   
            
    
    $('#next_year').live('click',function(){
        var year=$('.year').attr('title');
        var next_yaer=parseInt(year)+1;
        $('.year').attr('title',next_yaer);
        $('.year').html(""+next_yaer+"年");
        var html=load_calendar_month(next_yaer);
        $('.calendar_month').html(html);
    });
    
    function load_calendar(){
        var date= new Date()
        var yy = ( date.getYear() < 1900 ) ? ( 1900 + date.getYear() ) : date.getYear();
        $('.year').html(""+yy+"年");
        var html=load_calendar_month(yy);
        $('.calendar_month').html(html);
        $('.year').attr('title',yy);
    }
    
    function load_calendar_month(year){
        var html="";
        var res=check_article_num(year);
        $.each(res.data, function (i, n){
            var time=year+'-'+i;
            if(n !='0'){
                html +="<li class='bor2'><a href='?m=knowledge&a=index&time="+time+"'>"+i+"月</a></li>";
            }
            else{
                html +="<li class='bor2'>"+i+"月</li>";
            }
        });
        return html;
    }

    function check_article_num(year){
        var count;
        $.ajax({
            async:false,
            type: "GET",
            url: "?m=knowledge&a=check_article_num",
            cache:false,
            data:'year='+year,
            dataType: 'json',
            success: function(data){
               count=data;
               return count;
            }
        });
        return count;
    }
    
    function get_article_count(){
         $.ajax({
            type: "POST",
            url: "?m=knowledge&a=get_article_count",
            cache:false,
            dataType: 'json',
            success: function(data){
                $('#all_count').html(data.data.all_count);
                $('#prev_count').html(data.data.prev_count);
                $('#now_count').html(data.data.now_count);
            }
        });
    };
    
</script>
<script src="{$Think.config.PUBLIC_URL}/Js/treeview/lib/jquery.cookie.js" type="text/javascript"></script>
<script src="{$Think.config.PUBLIC_URL}/Js/treeview/jquery.treeview.js" type="text/javascript"></script>
<script type="text/javascript" src="{$Think.config.PUBLIC_URL}/Js/treeview/demo/demo.js"></script>
